packages:
 - !include common/openamber.yaml

esp32:
  variant: esp32s3
  flash_size: 16MB
  cpu_frequency: 240MHZ
  framework:
    sdkconfig_options:
      CONFIG_ESP32S3_DEFAULT_CPU_FREQ_240: "y"
      CONFIG_ESP32S3_DATA_CACHE_64KB: "y"
      CONFIG_ESP32S3_DATA_CACHE_LINE_64B: "y"
      CONFIG_SPIRAM_MODE_OCT: "y"
      CONFIG_SPIRAM_SPEED_80M: "y"
      CONFIG_ESP_MAIN_TASK_STACK_SIZE: "16384"

esphome:
  platformio_options:
    board_build.arduino.memory_type: qio_opi
    board_build.flash_mode: dio
  on_boot:
    then:
      - script.execute: backlight_script

uart:
  rx_pin:
    number: GPIO43
    inverted: False
  tx_pin:
    number: GPIO44
    inverted: False

psram:
  mode: octal
  speed: 80MHz

ch422g:
  - id: ch422g_hub

i2c:
  sda: GPIO08
  scl: GPIO09
  scan: True
  id: i2_bus_a
  frequency: 400kHz

display:
  - platform: mipi_rgb
    model: WAVESHARE-5-1024X600
    id: my_display
    dimensions:
      width: 1024
      height: 600
    auto_clear_enabled: false
    update_interval: 16ms
    color_order: RGB
    pclk_frequency: 16MHz
    pclk_inverted: true
    data_pins:
      red: [GPIO1, GPIO2, GPIO42, GPIO41, GPIO40]
      green: [GPIO39, GPIO0, GPIO45, GPIO48, GPIO47, GPIO21]
      blue: [GPIO14, GPIO38, GPIO18, GPIO17, GPIO10]
    pclk_pin: GPIO7
    de_pin: GPIO5
    hsync_pin: 
      number: GPIO46
      ignore_strapping_warning: true
    vsync_pin: 
      number: GPIO3
      ignore_strapping_warning: true
    reset_pin:
      ch422g: ch422g_hub
      number: 3

switch:
 - platform: gpio
   name: backlight_pin
   id: backlight
   internal: True
   restore_mode: ALWAYS_ON
   pin:
     ch422g: ch422g_hub
     number: 2
     inverted: false

touchscreen:
  - platform: gt911
    address: 0x5D
    id: my_touchscreen
    interrupt_pin: GPIO4
    reset_pin:
      ch422g: ch422g_hub
      number: 1
    on_touch:
      - script.execute: backlight_script

script:
  - id: backlight_script
    mode: restart
    then:
      - switch.turn_on: backlight
      - delay: 60s
      - switch.turn_off: backlight

interval:
 - interval: 5s
   then: !include lvgl/ui_update_loop.yaml

image:
  - file: "lvgl/images/water_circuit.png"
    id: img_water_circuit
    type: RGB565
    transparency: alpha_channel
    resize: 420x420

font: !include lvgl/fonts.yaml

lvgl:
  disp_bg_color: 0x0A2747
  widgets:
    - !include lvgl/root_bg.yaml
    - !include lvgl/header_bar.yaml
    - !include lvgl/page_home.yaml
    - !include lvgl/nav_bar.yaml
    - !include lvgl/boot_screen.yaml